/**
 * Mapping.js
 * 税理士・会計ソフト準拠の「正解」データ定義
 * (Source: SODA FACTORY JAPAN PDF & Gourmet Labo CSV)
 *
 * 責務:
 * - AIが出力してよい勘定科目の厳密なリスト (VALID_ACCOUNT_TITLES)
 * - 店舗名→勘定科目の確定マッピング辞書 (STORE_ACCOUNT_MAP)
 */

// ▼ AIが出力してよい「唯一の」勘定科目リスト
// これ以外の単語（配送費、システム料など）は使用禁止とする
const VALID_ACCOUNT_TITLES = [
  // --- 損益計算書 (費用) ---
  "荷造運賃",       // 宅配便、送料
  "旅費交通費",     // 電車、バス、タクシー、宿泊、出張
  "車両費",         // ガソリン、駐車場、ETC、レンタカー
  "地代家賃",       // 家賃、共益費、更新料
  "水道光熱費",     // 電気、ガス、水道
  "通信費",         // 電話、ネット回線、切手
  "支払手数料",     // 振込手数料、決済手数料、SaaS、クラウド利用料(SODA流)
  "外注費",         // スポット人材、業務委託 (Timee等)
  "広告宣伝費",     // 広告代
  "交際費",         // 接待、贈答、百貨店
  "会議費",         // 打ち合わせ飲食、カフェ、コンビニ
  "消耗品費",       // 事務用品、備品、10万円未満の物品
  "新聞図書費",     // 書籍、新聞、有料メルマガ
  "諸会費",         // 年会費、組合費
  "租税公課",       // 印紙、公的証明書、公租公課
  "支払報酬料",     // 税理士・行政書士報酬
  "雑費",           // その他分類不能な少額経費
  "仕入高",         // 商品仕入

  // --- 貸借対照表 (資産・負債) ---
  "仮払金",         // 用途未確定、一時払い
  "立替金",         // 役員・従業員立替
  "未払金",         // クレジットカード未引落分など
  "買掛金",         // 請求書払い
  "短期借入金"      // 役員借入など
];

// ▼ 店舗名・キーワードからの確定マッピング辞書
// キーは部分一致（大文字小文字不問）で検索される
// ★長いキーワードを先に定義すること（"Amazon Web Services" → "Amazon" の順）
const STORE_ACCOUNT_MAP = {

  // ==========================================================
  // 荷造運賃 — 宅配便・配送
  // ==========================================================
  "ヤマト運輸": "荷造運賃",
  "YAMATO": "荷造運賃",
  "佐川急便": "荷造運賃",
  "SAGAWA": "荷造運賃",
  "DHL": "荷造運賃",
  "FedEx": "荷造運賃",
  "SBSグローバル": "荷造運賃",
  "物研": "荷造運賃",
  "日本郵便": "荷造運賃",
  "ゆうパック": "荷造運賃",
  "クロネコ": "荷造運賃",
  "西濃運輸": "荷造運賃",
  "福山通運": "荷造運賃",

  // ==========================================================
  // 旅費交通費 — 電車・バス・タクシー・宿泊
  // ==========================================================
  "Smart EX": "旅費交通費",
  "SMARTEX": "旅費交通費",
  "EX予約": "旅費交通費",
  "ＥＸ予約": "旅費交通費",
  "JR東海": "旅費交通費",
  "JR西日本": "旅費交通費",
  "JR東日本": "旅費交通費",
  "JR九州": "旅費交通費",
  "JR四国": "旅費交通費",
  "JR北海道": "旅費交通費",
  "鉄道": "旅費交通費",
  "電鉄": "旅費交通費",
  "新幹線": "旅費交通費",
  "Taxi": "旅費交通費",
  "タクシー": "旅費交通費",
  "近鉄": "旅費交通費",
  "南海": "旅費交通費",
  "阪急電鉄": "旅費交通費",
  "阪神電鉄": "旅費交通費",
  "京阪": "旅費交通費",
  "地下鉄": "旅費交通費",
  "メトロ": "旅費交通費",
  "モノレール": "旅費交通費",
  "東急": "旅費交通費",
  "西武": "旅費交通費",
  "小田急": "旅費交通費",
  "京王": "旅費交通費",
  "乗車券": "旅費交通費",
  "回数券": "旅費交通費",
  "定期券": "旅費交通費",
  "ICOCA": "旅費交通費",
  "Suica": "旅費交通費",
  "PASMO": "旅費交通費",
  // 宿泊
  "ホテル": "旅費交通費",
  "Hotel": "旅費交通費",
  "旅館": "旅費交通費",
  "inn": "旅費交通費",
  "東横イン": "旅費交通費",
  "アパホテル": "旅費交通費",
  "ルートイン": "旅費交通費",
  "ドーミーイン": "旅費交通費",
  "民泊": "旅費交通費",
  // タクシー会社
  "日本交通": "旅費交通費",
  "第一交通": "旅費交通費",
  "大和交通": "旅費交通費",
  "MKタクシー": "旅費交通費",
  "都タクシー": "旅費交通費",
  "交通社": "旅費交通費",
  "交通": "旅費交通費",
  // 航空
  "ANA": "旅費交通費",
  "JAL": "旅費交通費",
  "航空": "旅費交通費",
  "空港": "旅費交通費",

  // ==========================================================
  // 車両費 — ガソリン・駐車場・高速・整備
  // ==========================================================
  // ガソリンスタンド
  "ENEOS": "車両費",
  "Idemitsu": "車両費",
  "出光": "車両費",
  "コスモ石油": "車両費",
  "Apollo Station": "車両費",
  "アポロステーション": "車両費",
  "Usappy": "車両費",
  "宇佐美": "車両費",
  "ガソリン": "車両費",
  "軽油": "車両費",
  "給油": "車両費",
  "キグナス": "車両費",
  "SOLATO": "車両費",
  "太陽石油": "車両費",
  // 駐車場
  "タイムズ": "車両費",
  "リパーク": "車両費",
  "三井のリパーク": "車両費",
  "パーキング": "車両費",
  "パーク": "車両費",
  "駐車場": "車両費",
  "コインパ": "車両費",
  "月極": "車両費",
  "NPC24H": "車両費",
  "Trust Park": "車両費",
  "名鉄協商": "車両費",
  "ナビパーク": "車両費",
  // 高速道路・有料道路
  "NEXCO": "車両費",
  "首都高": "車両費",
  "阪神高速": "車両費",
  "本州四国連絡高速": "車両費",
  "道路公社": "車両費",
  "スカイライン": "車両費",
  "ターンパイク": "車両費",
  "有料道路": "車両費",
  "ドライブウェイ": "車両費",
  "自動車道": "車両費",
  // 駐車場（個別ブランド）
  "エコロシティ": "車両費",
  "パラカ": "車両費",
  "Paraca": "車両費",
  "OnePark": "車両費",
  "One Park": "車両費",
  "ワンパーク": "車両費",
  "アパルトマン": "車両費",
  "モータープール": "車両費",
  "Parking": "車両費",
  "PARKING": "車両費",
  "GSパーク": "車両費",
  "Gパーク": "車両費",
  "トレジャーパーク": "車両費",
  "キョウテク": "車両費",
  "フレンドパーク": "車両費",
  "ザ・パーク": "車両費",
  "ユアーズパーク": "車両費",
  "アップルパーク": "車両費",
  "ダイヤパーク": "車両費",
  "エコステーション": "車両費",
  "ジャパンプロパティ": "車両費",
  "汀商事": "車両費",
  // 運転代行
  "代行": "車両費",
  // 自動車メーカー・ディーラー
  "SUBARU": "車両費",
  "スバル": "車両費",
  // 車両整備・用品
  "オートバックス": "車両費",
  "イエローハット": "車両費",
  "洗車": "車両費",
  "カーウォッシュ": "車両費",
  "車検": "車両費",
  "タイヤ館": "車両費",
  "レンタカー": "車両費",
  "ニッポンレンタカー": "車両費",
  "トヨタレンタ": "車両費",
  "オリックスレンタ": "車両費",

  // ==========================================================
  // 支払手数料 — IT・クラウド・決済・振込
  // ==========================================================
  "Amazon Web Services": "支払手数料",
  "AWS": "支払手数料",
  "Google Cloud": "支払手数料",
  "Shopify": "支払手数料",
  "Stripe": "支払手数料",
  "XServer": "支払手数料",
  "ムームードメイン": "支払手数料",
  "Trip.com": "支払手数料",
  "TEIKOKU": "支払手数料",
  "さくらインターネット": "支払手数料",
  "お名前.com": "支払手数料",
  "Zoom": "支払手数料",
  "Slack": "支払手数料",
  "ChatWork": "支払手数料",
  "Microsoft 365": "支払手数料",
  "Adobe": "支払手数料",
  "Canva": "支払手数料",
  "freee": "支払手数料",
  "マネーフォワード": "支払手数料",
  "Square": "支払手数料",
  "PayPal": "支払手数料",
  "振込手数料": "支払手数料",
  "ATM": "支払手数料",

  // ==========================================================
  // 外注費 — 人材・業務委託
  // ==========================================================
  "Timee": "外注費",
  "タイミー": "外注費",
  "Lancers": "外注費",
  "CrowdWorks": "外注費",
  "クラウドワークス": "外注費",
  "A Knots": "外注費",
  "ココナラ": "外注費",

  // ==========================================================
  // 会議費 — 飲食・カフェ・コンビニ
  // ==========================================================
  "Starbucks": "会議費",
  "スターバックス": "会議費",
  "Doutor": "会議費",
  "ドトール": "会議費",
  "Tully's": "会議費",
  "タリーズ": "会議費",
  "コメダ": "会議費",
  "珈琲館": "会議費",
  "上島珈琲": "会議費",
  "サンマルク": "会議費",
  "エクセルシオール": "会議費",
  "PRONTO": "会議費",
  "プロント": "会議費",
  "McDonald": "会議費",
  "マクドナルド": "会議費",
  "マクド": "会議費",
  "モスバーガー": "会議費",
  "吉野家": "会議費",
  "松屋": "会議費",
  "すき家": "会議費",
  "なか卯": "会議費",
  "CoCo壱番屋": "会議費",
  "ココイチ": "会議費",
  "丸亀製麺": "会議費",
  "餃子の王将": "会議費",
  "王将": "会議費",
  "大戸屋": "会議費",
  "やよい軒": "会議費",
  "リンガーハット": "会議費",
  "サイゼリヤ": "会議費",
  "ガスト": "会議費",
  "ロイヤルホスト": "会議費",
  "デニーズ": "会議費",
  "ジョイフル": "会議費",
  "ケンタッキー": "会議費",
  "KFC": "会議費",
  "ミスタードーナツ": "会議費",
  "ミスド": "会議費",
  "カフェ": "会議費",
  "喫茶": "会議費",
  "CAFE": "会議費",
  "Coffee": "会議費",
  // コンビニ
  "セブン-イレブン": "会議費",
  "セブンイレブン": "会議費",
  "セブン": "会議費",
  "ローソン": "会議費",
  "ファミリーマート": "会議費",
  "ファミマ": "会議費",
  "ミニストップ": "会議費",
  "デイリーヤマザキ": "会議費",
  // 居酒屋・焼肉・各種飲食（打合せ飲食）
  "居酒屋": "会議費",
  "焼肉": "会議費",
  "焼鳥": "会議費",
  "やきとり": "会議費",
  "寿司": "会議費",
  "すし": "会議費",
  "鮨": "会議費",
  "ラーメン": "会議費",
  "らーめん": "会議費",
  "うどん": "会議費",
  "そば": "会議費",
  "蕎麦": "会議費",
  "食堂": "会議費",
  "レストラン": "会議費",
  "ダイニング": "会議費",
  "Dining": "会議費",
  "ビストロ": "会議費",
  "トラットリア": "会議費",
  "弁当": "会議費",
  "仕出し": "会議費",
  // 和食・日本料理
  "料理": "会議費",
  "割烹": "会議費",
  "和食": "会議費",
  "懐石": "会議費",
  "御膳": "会議費",
  "天ぷら": "会議費",
  "天婦羅": "会議費",
  "天麩羅": "会議費",
  "とんかつ": "会議費",
  "トンカツ": "会議費",
  "豚カツ": "会議費",
  "串カツ": "会議費",
  "串揚": "会議費",
  "串焼": "会議費",
  "お好み焼": "会議費",
  "たこ焼": "会議費",
  "しゃぶしゃぶ": "会議費",
  "すき焼": "会議費",
  "鉄板焼": "会議費",
  "鉄板": "会議費",
  "海鮮": "会議費",
  "鮮魚": "会議費",
  "鍋": "会議費",
  "定食": "会議費",
  "丼": "会議費",
  "おでん": "会議費",
  "もつ": "会議費",
  // 肉・鶏・豚
  "焼き鳥": "会議費",
  "鶏": "会議費",
  "とり": "会議費",
  // 中華・エスニック
  "中華": "会議費",
  "中国料理": "会議費",
  "台湾料理": "会議費",
  "韓国料理": "会議費",
  "タイ料理": "会議費",
  "ベトナム料理": "会議費",
  "インド料理": "会議費",
  // 洋食・イタリアン・フレンチ
  "イタリアン": "会議費",
  "フレンチ": "会議費",
  "ステーキ": "会議費",
  "Steak": "会議費",
  "グリル": "会議費",
  "Grill": "会議費",
  "ハンバーグ": "会議費",
  "パスタ": "会議費",
  "ピザ": "会議費",
  "Pizza": "会議費",
  "カレー": "会議費",
  // 寿司（表記ゆれ対応）
  "寿し": "会議費",
  // 亭（料亭・食事処の接尾語）
  "亭": "会議費",
  // バー・酒場
  "Dining Bar": "会議費",
  "Shot Bar": "会議費",
  "Wine Bar": "会議費",
  "WINE BAR": "会議費",
  "Cocktail Bar": "会議費",
  "Beer Bar": "会議費",
  "Sports Bar": "会議費",
  "Bar ": "会議費",
  " Bar": "会議費",
  "BAR ": "会議費",
  " BAR": "会議費",
  "バー": "会議費",
  "酒場": "会議費",
  "酒処": "会議費",
  "酒房": "会議費",
  "酒蔵": "会議費",
  "炉端": "会議費",
  "ホルモン": "会議費",
  "居酒": "会議費",
  "酒亭": "会議費",
  "pub": "会議費",
  // キッチン・その他飲食
  "キッチン": "会議費",
  "Kitchen": "会議費",
  "ベーカリー": "会議費",
  "Bakery": "会議費",
  "パン屋": "会議費",
  "ブッフェ": "会議費",
  "ビュッフェ": "会議費",
  "バイキング": "会議費",
  "食事": "会議費",
  "食処": "会議費",
  "麺": "会議費",
  "茶屋": "会議費",
  "茶房": "会議費",
  // チェーン系（英語表記）
  "Royal Host": "会議費",
  "ROYAL HOST": "会議費",

  // ==========================================================
  // 交際費 — 接待・贈答・百貨店
  // ==========================================================
  "高島屋": "交際費",
  "Takashimaya": "交際費",
  "大丸": "交際費",
  "Daimaru": "交際費",
  "伊勢丹": "交際費",
  "三越": "交際費",
  "阪急百貨店": "交際費",
  "阪神百貨店": "交際費",
  "近鉄百貨店": "交際費",
  "そごう": "交際費",
  "西武百貨店": "交際費",
  "551蓬莱": "交際費",
  "ゴディバ": "交際費",
  "GODIVA": "交際費",
  "花キューピット": "交際費",
  "花屋": "交際費",
  "フラワー": "交際費",
  "ギフト": "交際費",
  "贈答": "交際費",
  "胡蝶蘭": "交際費",
  // 特殊字体
  "髙島屋": "交際費",
  // ゴルフ・接待
  "ゴルフ": "交際費",
  "Golf": "交際費",
  "GOLF": "交際費",
  "カントリークラブ": "交際費",
  "カントリー倶楽部": "交際費",
  "倶楽部": "交際費",
  "ゴルフ場": "交際費",
  "ゴルフクラブ": "交際費",
  "カントリー": "交際費",
  // 後援会・パーティー
  "後援会": "交際費",
  // スナック・ラウンジ（接待系）
  "スナック": "交際費",
  "ラウンジ": "交際費",
  // 百貨店一般
  "百貨店": "交際費",

  // ==========================================================
  // 消耗品費 — 事務用品・日用品・ドラッグストア・ホームセンター
  // ==========================================================
  "DAISO": "消耗品費",
  "ダイソー": "消耗品費",
  "Seria": "消耗品費",
  "セリア": "消耗品費",
  "キャンドゥ": "消耗品費",
  "MonotaRO": "消耗品費",
  "モノタロウ": "消耗品費",
  "Askul": "消耗品費",
  "アスクル": "消耗品費",
  "Amazon": "消耗品費",
  "楽天": "消耗品費",
  "ヨドバシ": "消耗品費",
  "ビックカメラ": "消耗品費",
  "ヤマダ電機": "消耗品費",
  "ケーズデンキ": "消耗品費",
  "エディオン": "消耗品費",
  "ジョーシン": "消耗品費",
  "Joshin": "消耗品費",
  "コーナン": "消耗品費",
  "カインズ": "消耗品費",
  "CAINZ": "消耗品費",
  "DCM": "消耗品費",
  "コメリ": "消耗品費",
  "ナフコ": "消耗品費",
  "ニトリ": "消耗品費",
  "IKEA": "消耗品費",
  "無印良品": "消耗品費",
  "MUJI": "消耗品費",
  "ドン・キホーテ": "消耗品費",
  "ドンキ": "消耗品費",
  "ロフト": "消耗品費",
  "LOFT": "消耗品費",
  "東急ハンズ": "消耗品費",
  "ハンズ": "消耗品費",
  // ドラッグストア
  "マツモトキヨシ": "消耗品費",
  "マツキヨ": "消耗品費",
  "ウエルシア": "消耗品費",
  "ツルハ": "消耗品費",
  "サンドラッグ": "消耗品費",
  "スギ薬局": "消耗品費",
  "ココカラファイン": "消耗品費",
  "ダイコク": "消耗品費",
  "キリン堂": "消耗品費",
  "薬局": "消耗品費",
  "ドラッグ": "消耗品費",
  // スーパー（消耗品として）
  "イオン": "消耗品費",
  "AEON": "消耗品費",
  "イトーヨーカドー": "消耗品費",
  "ライフ": "消耗品費",
  "西友": "消耗品費",
  "マルエツ": "消耗品費",
  "業務スーパー": "消耗品費",
  "コストコ": "消耗品費",
  "Costco": "消耗品費",
  "万代": "消耗品費",
  "関西スーパー": "消耗品費",
  "オークワ": "消耗品費",
  // 衣料・アパレル
  "UNIQLO": "消耗品費",
  "ユニクロ": "消耗品費",
  "ジーユー": "消耗品費",
  "ZARA": "消耗品費",
  "H&M": "消耗品費",
  "FABRIC TOKYO": "消耗品費",
  "洋服の青山": "消耗品費",
  "AOKI": "消耗品費",
  "アオキ": "消耗品費",
  "しまむら": "消耗品費",
  "ワークマン": "消耗品費",
  "WORKMAN": "消耗品費",
  "衣料": "消耗品費",
  // 文房具
  "コクヨ": "消耗品費",
  "文具": "消耗品費",

  // ==========================================================
  // 新聞図書費 — 書籍・新聞・サブスク
  // ==========================================================
  "紀伊國屋": "新聞図書費",
  "紀伊国屋": "新聞図書費",
  "Kinokuniya": "新聞図書費",
  "TSUTAYA": "新聞図書費",
  "Tsutaya": "新聞図書費",
  "蔦屋書店": "新聞図書費",
  "ジュンク堂": "新聞図書費",
  "丸善": "新聞図書費",
  "三省堂": "新聞図書費",
  "ブックオフ": "新聞図書費",
  "BOOKOFF": "新聞図書費",
  "書店": "新聞図書費",
  "書房": "新聞図書費",
  "本屋": "新聞図書費",
  "新聞": "新聞図書費",
  "日経": "新聞図書費",

  // ==========================================================
  // 地代家賃
  // ==========================================================
  "上本町東ビル": "地代家賃",
  "家賃": "地代家賃",
  "共益費": "地代家賃",
  "管理費": "地代家賃",
  "更新料": "地代家賃",

  // ==========================================================
  // 水道光熱費
  // ==========================================================
  "電力": "水道光熱費",
  "関西電力": "水道光熱費",
  "東京電力": "水道光熱費",
  "中部電力": "水道光熱費",
  "大阪ガス": "水道光熱費",
  "東京ガス": "水道光熱費",
  "水道局": "水道光熱費",
  "水道料": "水道光熱費",

  // ==========================================================
  // 通信費
  // ==========================================================
  "ドコモ": "通信費",
  "docomo": "通信費",
  "ソフトバンク": "通信費",
  "SoftBank": "通信費",
  "KDDI": "通信費",
  "NTT": "通信費",
  "UQ": "通信費",
  "楽天モバイル": "通信費",
  "切手": "通信費",
  "郵便": "通信費",
  "レターパック": "通信費",

  // ==========================================================
  // 広告宣伝費
  // ==========================================================
  "広告": "広告宣伝費",
  "チラシ": "広告宣伝費",
  "ポスティング": "広告宣伝費",
  "看板": "広告宣伝費",
  "印刷": "広告宣伝費",
  "名刺": "広告宣伝費",

  // ==========================================================
  // 諸会費 — 年会費・組合費・団体会費
  // ==========================================================
  "青年会議所": "諸会費",
  "JCI": "諸会費",
  "ロータリー": "諸会費",
  "Rotary": "諸会費",
  "ライオンズ": "諸会費",
  "Lions": "諸会費",
  "商工会議所": "諸会費",
  "商工会": "諸会費",
  "同友会": "諸会費",
  "協会": "諸会費",
  "協同組合": "諸会費",
  "組合": "諸会費",
  "連合会": "諸会費",
  "年会費": "諸会費",
  "会費": "諸会費",
  "自治会": "諸会費",
  "町内会": "諸会費",

  // ==========================================================
  // 租税公課
  // ==========================================================
  "印紙": "租税公課",
  "市役所": "租税公課",
  "区役所": "租税公課",
  "法務局": "租税公課",
  "県税": "租税公課",
  "都税": "租税公課",
  "府税": "租税公課",
  "税務署": "租税公課",

  // ==========================================================
  // 支払報酬料
  // ==========================================================
  "税理士": "支払報酬料",
  "会計事務所": "支払報酬料",
  "行政書士": "支払報酬料",
  "司法書士": "支払報酬料",
  "社労士": "支払報酬料",
  "弁護士": "支払報酬料"
};

// ▼ 店名カテゴリごとの「許容される勘定科目」リスト
// Geminiの提案がこのリスト内なら採用、外なら警告
// 目的: 明らかにおかしい仕訳を防ぐ（スタバ→車両費 など）
const ACCOUNT_TITLE_ALLOWED_MAP = {
  // カフェ・コンビニ・飲食店
  "カフェ": ["会議費", "福利厚生費", "交際費"],
  "コンビニ": ["会議費", "福利厚生費", "消耗品費"],
  "飲食店": ["会議費", "交際費", "福利厚生費"],

  // ガソリン・車両
  "ガソリンスタンド": ["車両費", "旅費交通費"],
  "駐車場": ["車両費", "旅費交通費"],
  "高速道路": ["車両費", "旅費交通費"],

  // 百貨店・贈答
  "百貨店": ["交際費", "消耗品費", "福利厚生費"],

  // EC（品名で判断するため許容範囲は広い）
  "EC": ["消耗品費", "新聞図書費", "支払手数料", "広告宣伝費", "会議費", "福利厚生費"],

  // 交通
  "交通": ["旅費交通費", "車両費"],
  "宿泊": ["旅費交通費"],

  // 個人名（飲食店と推定）
  "個人名": ["会議費", "交際費", "支払報酬料"]
};

/**
 * 店名からカテゴリを判定
 * @param {string} storeName
 * @return {string|null} カテゴリ名
 */
function getStoreCategory_(storeName) {
  const s = String(storeName).toLowerCase();

  // カフェ
  if (/starbucks|スターバックス|ドトール|タリーズ|コメダ|カフェ|coffee|珈琲/.test(s)) {
    return "カフェ";
  }

  // コンビニ
  if (/セブン|ローソン|ファミリーマート|ファミマ|ミニストップ/.test(s)) {
    return "コンビニ";
  }

  // 飲食店
  if (/居酒屋|焼肉|寿司|ラーメン|レストラン|食堂|料理|割烹|バー|酒/.test(s)) {
    return "飲食店";
  }

  // ガソリンスタンド
  if (/eneos|出光|コスモ|石油|ガソリン|給油/.test(s)) {
    return "ガソリンスタンド";
  }

  // 駐車場
  if (/タイムズ|リパーク|パーキング|駐車/.test(s)) {
    return "駐車場";
  }

  // 高速道路
  if (/nexco|首都高|阪神高速|高速|有料道路/.test(s)) {
    return "高速道路";
  }

  // 百貨店
  if (/高島屋|大丸|伊勢丹|三越|阪急百貨店|百貨店/.test(s)) {
    return "百貨店";
  }

  // EC
  if (/amazon|楽天|ヨドバシ|アスクル|monotaro/.test(s)) {
    return "EC";
  }

  // 交通
  if (/タクシー|電鉄|鉄道|jr|新幹線|航空|ana|jal/.test(s)) {
    return "交通";
  }

  // 宿泊
  if (/ホテル|hotel|旅館|inn/.test(s)) {
    return "宿泊";
  }

  // 個人名判定（カタカナ・漢字のみで、上記にマッチしない）
  if (/^[ぁ-んァ-ヶー一-龠々]+$/.test(storeName) && storeName.length <= 10) {
    // 短い日本語名で他にマッチしない → 個人名の可能性
    return "個人名";
  }

  return null;
}

// ▼ 正規表現パターンによる車両費検出（保守的 — 誤マッチ防止）
// STORE_ACCOUNT_MAP にヒットしない場合のみ、最終手段として使用される
const VEHICLE_PATTERNS = [
  // ガソリンスタンド: 末尾が全角or漢字+SS (百舌鳥SS, 岸和田SS 等)
  /[ぁ-ん|ァ-ヶ|亜-熙]SS$/,
  /[ぁ-ん|ァ-ヶ|亜-熙]ＳＳ$/,

  // 洗車
  /car\s*wash/i,

  // ETC明細（"ETC利用" 等、単独の "ETC" はSTORE_ACCOUNT_MAPで処理）
  /ETC利用/,
  /ETC料金/
];
